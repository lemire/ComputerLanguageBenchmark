<!DOCTYPE html>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="robots" content="noindex,follow,noarchive">

<title>pidigits Fortran Intel program | Computer Language Benchmarks Game </title>
<style><!--
a{color:black;text-decoration:none}article{padding: 0 0 2.9em}article,div,footer,header{margin:auto;width:92%}body{font:100% Droid Sans,Ubuntu,Verdana,sans-serif;margin:0;-webkit-text-size-adjust:100%}h1,h2,h3,li a{font-family:Ubuntu Mono,Consolas,Menlo,monospace}div,footer,header{max-width:31em}footer{padding:2.6em 0 0}h1{font-size:1.4em;font-weight:bold;margin:0;padding:.4em}h1,h1 a{color:white}h2,h3{margin:1.5em 0 0}h2{font-size:1.4em;font-weight:normal}h3{font-size:1.2em}li{list-style-type:none;vertical-align:top}li a{display:block;font-size:1.2em;margin:.5em .5em 0;padding:.5em .5em .3em}ul{clear:left;margin:-0.3em 0 1.5em;padding-left:0;text-align:center}p{color:#333;line-height:1.4;margin:.3em 0 0}p a,a span{border-bottom:.1em solid #333;padding-bottom:.1em}#u64,#u64q{background-color:#c90016}#u32{background-color:#ffb515}#u32q{background-color:#ff6309}.com,.slc{color:#888}.kwa{color:#066}.kwb{color:#900}.kwc{color:#050}.kwa,.kwb,.kwc{font-weight:bold}.dstr,.str,.sym,.num{color:#930}pre{color:#222;font-size:1em;overflow-wrap:break-word;white-space:pre-wrap;word-wrap:break-word}@media only screen and (min-width:60em){article,footer,header{font-size:1.25em}}
--></style>
<link rel="shortcut icon" href="./favicon.ico">
<header id="top">
  <h1 id="u64q"><a href="./index.html">The&nbsp;Computer&nbsp;Language<br>Benchmarks&nbsp;Game</a></h1>
</header>
<article>
  <div>
    <h2>pidigits Fortran Intel program</h2>
    <aside>
      <p><a href="./pidigits-description.html#pidigits">description</a>
    </aside>
  </div>
  <section>
    </div>
      <h3>source code</h3>
    </div>
    <pre>
<span class="slc">! The Computer Language Benchmarks Game</span>
<span class="slc">! http://benchmarksgame.alioth.debian.org/</span>
<span class="slc">!</span>
<span class="slc">! contributed by Steve Decker</span>
<span class="slc">! compilation:</span>
<span class="slc">!    g95 -O3 -funroll-loops -fomit-frame-pointer pidigits.f90</span>
<span class="slc">!    ifort -O -ip pidigits.f90</span>

<span class="kwa">module</span> big_int_mod
  <span class="kwa">implicit none</span>
  <span class="kwa">save</span>
  
  <span class="kwa">integer</span><span class="opt">,</span> <span class="kwa">parameter</span><span class="opt">,</span> private <span class="opt">::</span> Pwr <span class="opt">=</span> <span class="num">15</span><span class="opt">,</span> Base <span class="opt">=</span> <span class="num">2</span><span class="opt">**</span>Pwr<span class="opt">,</span> maxDigs <span class="opt">=</span> <span class="num">2558</span>

  <span class="kwa">type</span> big_int
     private
     <span class="kwa">integer</span> <span class="opt">::</span> sigDigs
     <span class="kwa">logical</span> <span class="opt">::</span> sign
     <span class="kwa">integer</span><span class="opt">,</span> <span class="kwa">dimension</span><span class="opt">(</span>maxDigs<span class="opt">) ::</span> digits
  <span class="kwa">end type</span> big_int

  <span class="kwa">interface</span> <span class="kwd">assignment</span> <span class="opt">(=)</span>
     <span class="kwa">module</span> procedure int_to_big_int
  <span class="kwa">end interface</span>
  
  <span class="kwa">interface</span> <span class="kwd">operator</span> <span class="opt">(*)</span>
     <span class="kwa">module</span> procedure big_int_times_int
  <span class="kwa">end interface</span>
  
  <span class="kwa">interface</span> <span class="kwd">operator</span> <span class="opt">(+)</span>
     <span class="kwa">module</span> procedure big_int_plus_big_int
  <span class="kwa">end interface</span>

  <span class="kwa">interface</span> <span class="kwd">operator</span> <span class="opt">(/)</span>
     <span class="kwa">module</span> procedure big_int_div_big_int
  <span class="kwa">end interface</span>

<span class="kwa">contains</span>
  
  <span class="kwa">subroutine</span> <span class="kwd">int_to_big_int</span><span class="opt">(</span>bi<span class="opt">,</span> n<span class="opt">)</span>
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwd">intent</span><span class="opt">(</span>inout<span class="opt">) ::</span> bi
    <span class="kwa">integer</span><span class="opt">,</span>       <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">)    ::</span> n

    <span class="kwa">integer</span> <span class="opt">::</span> i

    <span class="kwa">if</span> <span class="opt">(</span>n <span class="opt">&gt;</span> <span class="num">0</span><span class="opt">)</span> <span class="kwa">then</span>
       bi <span class="opt">=</span> <span class="kwd">big_int</span><span class="opt">(</span><span class="num">1</span><span class="opt">, .</span>true<span class="opt">., (/</span> n<span class="opt">, (</span><span class="num">0</span><span class="opt">,</span> i <span class="opt">=</span> <span class="num">2</span><span class="opt">,</span> maxDigs<span class="opt">) /) )</span>
    <span class="kwa">else</span>
       bi <span class="opt">=</span> <span class="kwd">big_int</span><span class="opt">(</span><span class="num">0</span><span class="opt">, .</span>true<span class="opt">.,</span> <span class="num">0</span><span class="opt">)</span>
    <span class="kwa">end if</span>
  <span class="kwa">end subroutine</span> int_to_big_int
  
  <span class="kwa">function</span> <span class="kwd">big_int_times_int</span><span class="opt">(</span>bi<span class="opt">,</span> n<span class="opt">)</span> <span class="kwd">result</span><span class="opt">(</span>c<span class="opt">)</span>
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> bi
    <span class="kwa">integer</span><span class="opt">,</span>       <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> n
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">) ::</span> c

    <span class="kwa">integer</span> <span class="opt">::</span> m<span class="opt">,</span> i<span class="opt">,</span> curDig<span class="opt">,</span> k<span class="opt">,</span> j<span class="opt">,</span> carry
    
    c <span class="opt">=</span> <span class="kwd">big_int</span><span class="opt">(</span><span class="num">0</span><span class="opt">, .</span>true<span class="opt">.,</span> <span class="num">0</span><span class="opt">)</span>
    <span class="kwa">if</span> <span class="opt">(</span>n <span class="opt">==</span> <span class="num">0</span> <span class="opt">.</span>or<span class="opt">.</span> bi<span class="opt">%</span>sigDigs <span class="opt">==</span> <span class="num">0</span><span class="opt">)</span> <span class="kwa">return</span>
    c<span class="opt">%</span>sign <span class="opt">=</span> n <span class="opt">&gt;=</span> <span class="num">0</span> <span class="opt">.</span>eqv<span class="opt">.</span> bi<span class="opt">%</span>sign
    m <span class="opt">=</span> <span class="kwd">abs</span><span class="opt">(</span>n<span class="opt">)</span>

    <span class="kwa">do</span> i <span class="opt">=</span> <span class="num">1</span><span class="opt">,</span> maxDigs
       curDig <span class="opt">=</span> <span class="kwd">mod</span><span class="opt">(</span>m<span class="opt">,</span>Base<span class="opt">)</span>
       k <span class="opt">=</span> <span class="num">1</span>
       carry <span class="opt">=</span> <span class="num">0</span>
       <span class="kwa">do</span> j <span class="opt">=</span> i<span class="opt">,</span> i <span class="opt">+</span> bi<span class="opt">%</span>sigDigs <span class="opt">+</span> <span class="num">1</span>
          c<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>j<span class="opt">) =</span> c<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>j<span class="opt">) +</span> curDig <span class="opt">*</span> bi<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>k<span class="opt">) +</span> carry
          carry <span class="opt">=</span> <span class="kwd">ibits</span><span class="opt">(</span>c<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>j<span class="opt">),</span>Pwr<span class="opt">,</span>Pwr<span class="opt">+</span><span class="num">1</span><span class="opt">)</span>
          c<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>j<span class="opt">) =</span> <span class="kwd">mod</span><span class="opt">(</span>c<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>j<span class="opt">),</span>Base<span class="opt">)</span>
          k <span class="opt">=</span> k <span class="opt">+</span> <span class="num">1</span>
       <span class="kwa">end do</span>
       m <span class="opt">=</span> <span class="kwd">ibits</span><span class="opt">(</span>m<span class="opt">,</span>Pwr<span class="opt">,</span>Pwr<span class="opt">+</span><span class="num">1</span><span class="opt">)</span>
       <span class="kwa">if</span> <span class="opt">(</span>m <span class="opt">==</span> <span class="num">0</span><span class="opt">)</span> exit
    <span class="kwa">end do</span>
    <span class="kwa">do</span> j <span class="opt">=</span> i <span class="opt">+</span> bi<span class="opt">%</span>sigDigs<span class="opt">,</span> <span class="num">1</span><span class="opt">, -</span><span class="num">1</span>
       c<span class="opt">%</span>sigDigs <span class="opt">=</span> j
       <span class="kwa">if</span> <span class="opt">(</span>c<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>j<span class="opt">) /=</span> <span class="num">0</span><span class="opt">)</span> exit
    <span class="kwa">end do</span>
  <span class="kwa">end function</span> big_int_times_int

  <span class="kwa">function</span> <span class="kwd">big_int_plus_big_int</span><span class="opt">(</span>bi1<span class="opt">,</span> bi2<span class="opt">)</span> <span class="kwd">result</span><span class="opt">(</span>c<span class="opt">)</span>
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> target<span class="opt">,</span> <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> bi1<span class="opt">,</span> bi2
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">) ::</span> c
    
    <span class="kwa">integer</span> <span class="opt">::</span> i<span class="opt">,</span> carry<span class="opt">,</span> n
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwa">pointer</span> <span class="opt">::</span> a<span class="opt">,</span> b

    c <span class="opt">=</span> <span class="kwd">big_int</span><span class="opt">(</span><span class="num">0</span><span class="opt">, .</span>true<span class="opt">.,</span> <span class="num">0</span><span class="opt">)</span>

    <span class="kwa">if</span> <span class="opt">(</span>bi1<span class="opt">%</span>sigDigs <span class="opt">==</span> <span class="num">0</span><span class="opt">)</span> <span class="kwa">then</span>
       c <span class="opt">=</span> bi2
       <span class="kwa">return</span>
    <span class="kwa">else if</span> <span class="opt">(</span>bi2<span class="opt">%</span>sigDigs <span class="opt">==</span> <span class="num">0</span><span class="opt">)</span> <span class="kwa">then</span>
       c <span class="opt">=</span> bi1
       <span class="kwa">return</span>
    <span class="kwa">end if</span>

    <span class="kwa">if</span> <span class="opt">(</span>bi1<span class="opt">%</span>sign <span class="opt">.</span>eqv<span class="opt">.</span> bi2<span class="opt">%</span>sign<span class="opt">)</span> <span class="kwa">then</span>
       c<span class="opt">%</span>sign <span class="opt">=</span> bi1<span class="opt">%</span>sign
       carry <span class="opt">=</span> <span class="num">0</span>
       n <span class="opt">=</span> <span class="kwd">max</span><span class="opt">(</span>bi1<span class="opt">%</span>sigDigs<span class="opt">,</span> bi2<span class="opt">%</span>sigDigs<span class="opt">) +</span> <span class="num">1</span>
       <span class="kwa">do</span> i <span class="opt">=</span> <span class="num">1</span><span class="opt">,</span> n
          c<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">) =</span> bi1<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">) +</span> bi2<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">) +</span> carry
          carry <span class="opt">=</span> <span class="kwd">ibits</span><span class="opt">(</span>c<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">),</span>Pwr<span class="opt">,</span>Pwr<span class="opt">+</span><span class="num">1</span><span class="opt">)</span>
          c<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">) =</span> <span class="kwd">mod</span><span class="opt">(</span>c<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">),</span>Base<span class="opt">)</span>
       <span class="kwa">end do</span>
    <span class="kwa">else</span>
       <span class="kwa">if</span> <span class="opt">(</span><span class="kwd">greater_in_mag</span><span class="opt">(</span>bi1<span class="opt">,</span> bi2<span class="opt">))</span> <span class="kwa">then</span>
          a <span class="opt">=&gt;</span> bi1
          b <span class="opt">=&gt;</span> bi2
       <span class="kwa">else if</span> <span class="opt">(</span><span class="kwd">greater_in_mag</span><span class="opt">(</span>bi2<span class="opt">,</span> bi1<span class="opt">))</span> <span class="kwa">then</span>
          a <span class="opt">=&gt;</span> bi2
          b <span class="opt">=&gt;</span> bi1
       <span class="kwa">else</span>
          <span class="kwa">return</span>
       <span class="kwa">end if</span>

       n <span class="opt">=</span> <span class="kwd">max</span><span class="opt">(</span>a<span class="opt">%</span>sigDigs<span class="opt">,</span> b<span class="opt">%</span>sigDigs<span class="opt">)</span>
       c<span class="opt">%</span>sign <span class="opt">=</span> a<span class="opt">%</span>sign
       <span class="kwa">do</span> i <span class="opt">=</span> <span class="num">1</span><span class="opt">,</span> n
          <span class="kwa">if</span> <span class="opt">(</span>a<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">) &lt;</span> b<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">))</span> <span class="kwa">then</span>
             a<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">) =</span> a<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">) +</span> Base
             a<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">+</span><span class="num">1</span><span class="opt">) =</span> a<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">+</span><span class="num">1</span><span class="opt">) -</span> <span class="num">1</span>
          <span class="kwa">end if</span>
          c<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">) =</span> a<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">) -</span> b<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">)</span>
       <span class="kwa">end do</span>
    <span class="kwa">end if</span>

    <span class="kwa">do</span> i <span class="opt">=</span> n<span class="opt">,</span> <span class="num">1</span><span class="opt">, -</span><span class="num">1</span>
       c<span class="opt">%</span>sigDigs <span class="opt">=</span> i
       <span class="kwa">if</span> <span class="opt">(</span>c<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">) /=</span> <span class="num">0</span><span class="opt">)</span> exit
    <span class="kwa">end do</span>
  <span class="kwa">end function</span> big_int_plus_big_int

  <span class="kwa">function</span> <span class="kwd">big_int_div_big_int</span><span class="opt">(</span>a<span class="opt">,</span> b<span class="opt">)</span> <span class="kwd">result</span><span class="opt">(</span>c<span class="opt">)</span>
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> a<span class="opt">,</span> b
    <span class="kwa">integer</span>                   <span class="opt">::</span> c

    <span class="kwa">integer</span> <span class="opt">::</span> k<span class="opt">,</span> carry<span class="opt">,</span> n<span class="opt">,</span> j
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">) ::</span> accumulator

    c <span class="opt">=</span> <span class="num">0</span>
    <span class="kwa">if</span> <span class="opt">(</span>a<span class="opt">%</span>sigDigs <span class="opt">==</span> <span class="num">0</span><span class="opt">)</span> <span class="kwa">return</span>

    accumulator <span class="opt">=</span> <span class="kwd">big_int</span><span class="opt">(</span><span class="num">0</span><span class="opt">, .</span>true<span class="opt">.,</span> <span class="num">0</span><span class="opt">)</span>
    <span class="kwa">do</span> k <span class="opt">=</span> <span class="num">0</span><span class="opt">,</span> Base<span class="opt">-</span><span class="num">1</span>
       carry <span class="opt">=</span> <span class="num">0</span>
       n <span class="opt">=</span> <span class="kwd">max</span><span class="opt">(</span>accumulator<span class="opt">%</span>sigDigs<span class="opt">,</span> b<span class="opt">%</span>sigDigs<span class="opt">) +</span> <span class="num">1</span>
       <span class="kwa">do</span> j <span class="opt">=</span> <span class="num">1</span><span class="opt">,</span> n
          accumulator<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>j<span class="opt">) =  &amp;</span>
               accumulator<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>j<span class="opt">) +</span> b<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>j<span class="opt">) +</span> carry
          carry <span class="opt">=</span> <span class="kwd">ibits</span><span class="opt">(</span>accumulator<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>j<span class="opt">),</span>Pwr<span class="opt">,</span>Pwr<span class="opt">+</span><span class="num">1</span><span class="opt">)</span>
          accumulator<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>j<span class="opt">) =</span> <span class="kwd">mod</span><span class="opt">(</span>accumulator<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>j<span class="opt">),</span>Base<span class="opt">)</span>
       <span class="kwa">end do</span>
       <span class="kwa">do</span> j <span class="opt">=</span> n<span class="opt">,</span> <span class="num">1</span><span class="opt">, -</span><span class="num">1</span>
          accumulator<span class="opt">%</span>sigDigs <span class="opt">=</span> j
          <span class="kwa">if</span> <span class="opt">(</span>accumulator<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>j<span class="opt">) /=</span> <span class="num">0</span><span class="opt">)</span> exit
       <span class="kwa">end do</span>
       <span class="kwa">if</span> <span class="opt">(</span><span class="kwd">greater_in_mag</span><span class="opt">(</span>accumulator<span class="opt">,</span> a<span class="opt">))</span> <span class="kwa">then</span>
          c <span class="opt">=</span> k
          exit
       <span class="kwa">end if</span>
    <span class="kwa">end do</span>
  <span class="kwa">end function</span> big_int_div_big_int
  
  <span class="kwa">logical function</span> <span class="kwd">greater_in_mag</span><span class="opt">(</span>a<span class="opt">,</span> b<span class="opt">)</span>
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> a<span class="opt">,</span> b

    <span class="kwa">integer</span> <span class="opt">::</span> i

    greater_in_mag <span class="opt">= .</span>false<span class="opt">.</span>
    <span class="kwa">do</span> i <span class="opt">=</span> <span class="kwd">max</span><span class="opt">(</span>a<span class="opt">%</span>sigDigs<span class="opt">,</span> b<span class="opt">%</span>sigDigs<span class="opt">),</span> <span class="num">1</span><span class="opt">, -</span><span class="num">1</span>
       <span class="kwa">if</span> <span class="opt">(</span>a<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">) &gt;</span> b<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">))</span> <span class="kwa">then</span>
          greater_in_mag <span class="opt">= .</span>true<span class="opt">.</span>
          exit
       <span class="kwa">else if</span> <span class="opt">(</span>a<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">) &lt;</span> b<span class="opt">%</span><span class="kwd">digits</span><span class="opt">(</span>i<span class="opt">))</span> <span class="kwa">then</span>
          exit
       <span class="kwa">end if</span>
    <span class="kwa">end do</span>
  <span class="kwa">end function</span> greater_in_mag
<span class="kwa">end module</span> big_int_mod

<span class="kwa">module</span> pi_mod
  <span class="kwa">use</span> big_int_mod
  <span class="kwa">implicit none</span>

<span class="kwa">contains</span>

  <span class="kwa">function</span> <span class="kwd">lfts</span><span class="opt">(</span>k<span class="opt">)</span>
    <span class="kwa">integer</span><span class="opt">,</span> <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">)     ::</span> k
    <span class="kwa">integer</span><span class="opt">,</span> <span class="kwa">dimension</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">) ::</span> lfts

    lfts <span class="opt">=</span> <span class="kwd">reshape</span><span class="opt">( (/</span> k<span class="opt">,</span> <span class="num">0</span><span class="opt">,</span> <span class="num">4</span><span class="opt">*</span>k <span class="opt">+</span> <span class="num">2</span><span class="opt">,</span> <span class="num">2</span><span class="opt">*</span>k <span class="opt">+</span> <span class="num">1</span> <span class="opt">/), (/</span> <span class="num">2</span><span class="opt">,</span> <span class="num">2</span> <span class="opt">/) )</span>
  <span class="kwa">end function</span> lfts

  <span class="kwa">function</span> <span class="kwd">comp1</span><span class="opt">(</span>a<span class="opt">,</span> b<span class="opt">)</span>
    <span class="kwa">integer</span><span class="opt">,</span>       <span class="kwa">dimension</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">),</span> <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> a
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwa">dimension</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">),</span> <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> b
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwa">dimension</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">) ::</span> comp1

    <span class="kwd">comp1</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">1</span><span class="opt">) =</span> <span class="kwd">b</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">1</span><span class="opt">)*</span><span class="kwd">a</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">1</span><span class="opt">) +</span> <span class="kwd">b</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">1</span><span class="opt">)*</span><span class="kwd">a</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">2</span><span class="opt">)</span>
    <span class="kwd">comp1</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">1</span><span class="opt">) =</span> <span class="kwd">b</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">1</span><span class="opt">)*</span><span class="kwd">a</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">1</span><span class="opt">) +</span> <span class="kwd">b</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">1</span><span class="opt">)*</span><span class="kwd">a</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">)</span>
    <span class="kwd">comp1</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">2</span><span class="opt">) =</span> <span class="kwd">b</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">2</span><span class="opt">)*</span><span class="kwd">a</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">1</span><span class="opt">) +</span> <span class="kwd">b</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">)*</span><span class="kwd">a</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">2</span><span class="opt">)</span>
    <span class="kwd">comp1</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">) =</span> <span class="kwd">b</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">2</span><span class="opt">)*</span><span class="kwd">a</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">1</span><span class="opt">) +</span> <span class="kwd">b</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">)*</span><span class="kwd">a</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">)</span>
  <span class="kwa">end function</span> comp1

  <span class="kwa">function</span> <span class="kwd">comp2</span><span class="opt">(</span>a<span class="opt">,</span> b<span class="opt">)</span>
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwa">dimension</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">),</span> <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> a
    <span class="kwa">integer</span><span class="opt">,</span>       <span class="kwa">dimension</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">),</span> <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> b
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwa">dimension</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">) ::</span> comp2
    
    <span class="kwd">comp2</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">1</span><span class="opt">) =</span> <span class="kwd">a</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">1</span><span class="opt">)*</span><span class="kwd">b</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">1</span><span class="opt">) +</span> <span class="kwd">a</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">2</span><span class="opt">)*</span><span class="kwd">b</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">1</span><span class="opt">)</span>
    <span class="kwd">comp2</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">1</span><span class="opt">) =</span> <span class="kwd">a</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">1</span><span class="opt">)*</span><span class="kwd">b</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">1</span><span class="opt">) +</span> <span class="kwd">a</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">)*</span><span class="kwd">b</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">1</span><span class="opt">)</span>
    <span class="kwd">comp2</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">2</span><span class="opt">) =</span> <span class="kwd">a</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">1</span><span class="opt">)*</span><span class="kwd">b</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">2</span><span class="opt">) +</span> <span class="kwd">a</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">2</span><span class="opt">)*</span><span class="kwd">b</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">)</span>
    <span class="kwd">comp2</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">) =</span> <span class="kwd">a</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">1</span><span class="opt">)*</span><span class="kwd">b</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">2</span><span class="opt">) +</span> <span class="kwd">a</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">)*</span><span class="kwd">b</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">)</span>
  <span class="kwa">end function</span> comp2
  
  <span class="kwa">function</span> <span class="kwd">prod</span><span class="opt">(</span>z<span class="opt">,</span> n<span class="opt">)</span>
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwa">dimension</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">),</span> <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> z
    <span class="kwa">integer</span><span class="opt">,</span>                       <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> n
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwa">dimension</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">) ::</span> prod

    prod <span class="opt">=</span> <span class="kwd">comp1</span><span class="opt">(</span><span class="kwd">reshape</span><span class="opt">( (/</span> <span class="num">10</span><span class="opt">,</span> <span class="num">0</span><span class="opt">, -</span><span class="num">10</span><span class="opt">*</span>n<span class="opt">,</span> <span class="num">1</span> <span class="opt">/), (/</span> <span class="num">2</span><span class="opt">,</span> <span class="num">2</span> <span class="opt">/) ),</span> z<span class="opt">)</span>
  <span class="kwa">end function</span> prod
  
  <span class="kwa">logical function</span> <span class="kwd">safe</span><span class="opt">(</span>z<span class="opt">,</span> n<span class="opt">)</span>
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwa">dimension</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">),</span> <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> z
    <span class="kwa">integer</span><span class="opt">,</span>                       <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> n

    safe <span class="opt">=</span> n <span class="opt">== (</span><span class="kwd">z</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">1</span><span class="opt">) *</span> <span class="num">4</span> <span class="opt">+</span> <span class="kwd">z</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">2</span><span class="opt">)) / (</span><span class="kwd">z</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">1</span><span class="opt">) *</span> <span class="num">4</span> <span class="opt">+</span> <span class="kwd">z</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">))</span>
  <span class="kwa">end function</span> safe

  <span class="kwa">integer function</span> <span class="kwd">next</span><span class="opt">(</span>z<span class="opt">)</span>
    <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwa">dimension</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">),</span> <span class="kwd">intent</span><span class="opt">(</span>in<span class="opt">) ::</span> z
    
    next <span class="opt">= (</span><span class="kwd">z</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">1</span><span class="opt">) *</span> <span class="num">3</span> <span class="opt">+</span> <span class="kwd">z</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">2</span><span class="opt">)) / (</span><span class="kwd">z</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">1</span><span class="opt">) *</span> <span class="num">3</span> <span class="opt">+</span> <span class="kwd">z</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">))</span>
  <span class="kwa">end function</span> next
<span class="kwa">end module</span> pi_mod

<span class="kwa">program</span> pidigits
  <span class="kwa">use</span> pi_mod
  <span class="kwa">implicit none</span>

  <span class="kwa">character</span><span class="opt">(</span>len<span class="opt">=</span><span class="num">12</span><span class="opt">),</span> <span class="kwa">parameter</span>  <span class="opt">::</span> proForma <span class="opt">=</span> <span class="str">&quot;          &quot;</span> <span class="opt">//</span> <span class="kwd">achar</span><span class="opt">(</span><span class="num">9</span><span class="opt">) //</span> <span class="str">&quot;:&quot;</span>
  <span class="kwa">type</span><span class="opt">(</span>big_int<span class="opt">),</span> <span class="kwa">dimension</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">) ::</span> z
  <span class="kwa">integer</span>           <span class="opt">::</span> num<span class="opt">,</span> y<span class="opt">,</span> i <span class="opt">=</span> <span class="num">1</span><span class="opt">,</span> j <span class="opt">=</span> <span class="num">1</span><span class="opt">,</span> k <span class="opt">=</span> <span class="num">1</span>
  <span class="kwa">character</span><span class="opt">(</span>len<span class="opt">=</span><span class="num">17</span><span class="opt">) ::</span> outLine <span class="opt">=</span> proForma
  <span class="kwa">character</span><span class="opt">(</span>len<span class="opt">=</span><span class="num">4</span><span class="opt">)  ::</span> argv

  <span class="kwa">call</span> <span class="kwd">get_command_argument</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span> argv<span class="opt">)</span>
  <span class="kwa">read</span><span class="opt">(</span>argv<span class="opt">, *)</span> num

  <span class="kwd">z</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">1</span><span class="opt">) =</span> <span class="num">1</span><span class="opt">;</span> <span class="kwd">z</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">1</span><span class="opt">) =</span> <span class="num">0</span><span class="opt">;</span> <span class="kwd">z</span><span class="opt">(</span><span class="num">1</span><span class="opt">,</span><span class="num">2</span><span class="opt">) =</span> <span class="num">0</span><span class="opt">;</span> <span class="kwd">z</span><span class="opt">(</span><span class="num">2</span><span class="opt">,</span><span class="num">2</span><span class="opt">) =</span> <span class="num">1</span>

  <span class="kwa">do</span>
     y <span class="opt">=</span> <span class="kwd">next</span><span class="opt">(</span>z<span class="opt">)</span>
     <span class="kwa">if</span> <span class="opt">(</span><span class="kwd">safe</span><span class="opt">(</span>z<span class="opt">,</span> y<span class="opt">))</span> <span class="kwa">then</span>
        <span class="kwa">write</span><span class="opt">(</span>unit<span class="opt">=</span><span class="kwd">outLine</span><span class="opt">(</span>k<span class="opt">:</span>k<span class="opt">),</span> fmt<span class="opt">=</span><span class="str">&quot;(i1)&quot;</span><span class="opt">)</span> y
        <span class="kwa">if</span> <span class="opt">(</span>k <span class="opt">&lt;</span> <span class="num">10</span> <span class="opt">.</span>and<span class="opt">.</span> i <span class="opt">&lt;</span> num<span class="opt">)</span> <span class="kwa">then</span>
           k <span class="opt">=</span> k <span class="opt">+</span> <span class="num">1</span>
        <span class="kwa">else</span>
           k <span class="opt">=</span> <span class="num">1</span>
           <span class="kwa">write</span><span class="opt">(</span>unit<span class="opt">=</span><span class="kwd">outLine</span><span class="opt">(</span><span class="num">13</span><span class="opt">:</span><span class="num">17</span><span class="opt">),</span> fmt<span class="opt">=</span><span class="str">&quot;(i0)&quot;</span><span class="opt">)</span> i
           <span class="kwa">write</span><span class="opt">(*,</span> <span class="str">&quot;(a)&quot;</span><span class="opt">)</span> <span class="kwd">trim</span><span class="opt">(</span>outLine<span class="opt">)</span>
           outLine <span class="opt">=</span> proForma
        <span class="kwa">end if</span>
        <span class="kwa">if</span> <span class="opt">(</span>i <span class="opt">==</span> num<span class="opt">)</span> exit
        z <span class="opt">=</span> <span class="kwd">prod</span><span class="opt">(</span>z<span class="opt">,</span> y<span class="opt">)</span>
        i <span class="opt">=</span> i <span class="opt">+</span> <span class="num">1</span>
     <span class="kwa">else</span>
        z <span class="opt">=</span> <span class="kwd">comp2</span><span class="opt">(</span>z<span class="opt">,</span> <span class="kwd">lfts</span><span class="opt">(</span>j<span class="opt">))</span>
        j <span class="opt">=</span> j <span class="opt">+</span> <span class="num">1</span>
     <span class="kwa">end if</span>
  <span class="kwa">end do</span>
<span class="kwa">end program</span> pidigits
    </pre>
  </section>
  <section>
    <h3 id="log">notes, command-line, and program output</h3>
    <pre>
NOTES:
64-bit Ubuntu quad core
Intel(R) Fortran Intel(R) 64 Compiler for applications running on Intel(R) 64, Version 18.0.0.128 Build 20170811
Copyright (C) 1985-2017 Intel Corporation.  All rights reserved.
FOR NON-COMMERCIAL USE ONLY


Thu, 26 Oct 2017 19:44:45 GMT

MAKE:
/opt/src/intel/bin/ifort -O3 -xHost -ipo -lgmp pidigits.f90 -o pidigits.ifc_run
rm pidigits.f90

0.73s to complete and log all make actions

COMMAND LINE:
./pidigits.ifc_run 2000

PROGRAM FAILED 


PROGRAM OUTPUT:
3141592653	:10
5897932384	:20
6264338327	:30
9502884197	:40
1693993751	:50
0582097494	:60
4592307816	:70
4062862089	:80
9862803482	:90
5342117067	:100
9821480865	:110
1328230664	:120
7093844609	:130
5505822317	:140
2535940812	:150
8481117450	:160
2841027019	:170
3852110555	:180
9644622948	:190
9549303819	:200
6442881097	:210
5665933446	:220
1284756482	:230
3378678316	:240
5271201909	:250
1456485669	:260
2346034861	:270
0454326648	:280
2133936072	:290
6024914127	:300
3724587006	:310
6063155881	:320
7488152092	:330
0962829254	:340
0917153643	:350
6789259036	:360
0011330530	:370
5488204665	:380
2138414695	:390
1941511609	:400
4330572703	:410
6575959195	:420
3092186117	:430
3819326117	:440
9310511854	:450
8074462379	:460
9627495673	:470
5188575272	:480
4891227938	:490
1830119491	:500
2983367336	:510
2440656643	:520
0860213949	:530
4639522473	:540
7190702179	:550
8609437027	:560
7053921717	:570
6293176752	:580
3846748184	:590
6766940513	:600
2000568127	:610
1452635608	:620
2778577134	:630
2757789609	:640
1736371787	:650
2146844090	:660
1224953430	:670
1465495853	:680
7105079227	:690
9689258923	:700
5420199561	:710
1212902196	:720
0864034418	:730
1598136297	:740
7477130996	:750
0518707211	:760
3499999983	:770
7297804995	:780
1059731732	:790
8160963185	:800
9502445945	:810
5346908302	:820
6425223082	:830
5334468503	:840
5261931188	:850
1710100031	:860
3783875288	:870
6587533208	:880
3814206171	:890
7766914730	:900
3598253490	:910
4287554687	:920
3115956286	:930
3882353787	:940
5937519577	:950
8185778053	:960
2171226806	:970
6130019278	:980
7661119590	:990
9216420198	:1000
9380952572	:1010
0106548586	:1020

forrtl: severe (174): SIGSEGV, segmentation fault occurred
Image              PC                Routine            Line        Source             
pidigits.ifc_run   0000000000406FED  Unknown               Unknown  Unknown
libpthread-2.26.s  00007F0D076B1150  Unknown               Unknown  Unknown
pidigits.ifc_run   0000000000492A3D  Unknown               Unknown  Unknown
pidigits.ifc_run   0000000000405AD5  Unknown               Unknown  Unknown
pidigits.ifc_run   0000000000403A42  Unknown               Unknown  Unknown
pidigits.ifc_run   0000000000402AFE  Unknown               Unknown  Unknown
libc-2.26.so       00007F0D072DF1C1  __libc_start_main     Unknown  Unknown
pidigits.ifc_run   00000000004029EA  Unknown               Unknown  Unknown
    </pre>
  </section>
</article>
<footer>
  <nav>
    <ul>
      <li><a href="./license.html"><span>license</span></a>
    </ul>
  </nav>
</footer>

