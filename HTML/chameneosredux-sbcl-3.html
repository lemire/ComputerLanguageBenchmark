<!DOCTYPE html>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="robots" content="noindex,follow,noarchive">

<title>chameneos-redux Lisp SBCL&nbsp;#3 program | Computer Language Benchmarks Game </title>
<style><!--
a{color:black;text-decoration:none}article{padding: 0 0 2.9em}article,div,footer,header{margin:auto;width:92%}body{font:100% Droid Sans,Ubuntu,Verdana,sans-serif;margin:0;-webkit-text-size-adjust:100%}h1,h2,h3,li a{font-family:Ubuntu Mono,Consolas,Menlo,monospace}div,footer,header{max-width:31em}footer{padding:2.6em 0 0}h1{font-size:1.4em;font-weight:bold;margin:0;padding:.4em}h1,h1 a{color:white}h2,h3{margin:1.5em 0 0}h2{font-size:1.4em;font-weight:normal}h3{font-size:1.2em}li{list-style-type:none;vertical-align:top}li a{display:block;font-size:1.2em;margin:.5em .5em 0;padding:.5em .5em .3em}ul{clear:left;margin:-0.3em 0 1.5em;padding-left:0;text-align:center}p{color:#333;line-height:1.4;margin:.3em 0 0}p a,a span{border-bottom:.1em solid #333;padding-bottom:.1em}#u64,#u64q{background-color:#c90016}#u32{background-color:#ffb515}#u32q{background-color:#ff6309}.com,.slc{color:#888}.kwa{color:#066}.kwb{color:#900}.kwc{color:#050}.kwa,.kwb,.kwc{font-weight:bold}.dstr,.str,.sym,.num{color:#930}pre{color:#222;font-size:1em;overflow-wrap:break-word;white-space:pre-wrap;word-wrap:break-word}@media only screen and (min-width:60em){article,footer,header{font-size:1.25em}}
--></style>
<link rel="shortcut icon" href="./favicon.ico">
<header id="top">
  <h1 id="u64q"><a href="./index.html">The&nbsp;Computer&nbsp;Language<br>Benchmarks&nbsp;Game</a></h1>
</header>
<article>
  <div>
    <h2>chameneos-redux Lisp SBCL&nbsp;#3 program</h2>
    <aside>
      <p><a href="./chameneosredux-description.html#chameneosredux">description</a>
    </aside>
  </div>
  <section>
    </div>
      <h3>source code</h3>
    </div>
    <pre>
<span class="slc">;; The Computer Language Benchmarks Game</span>
<span class="slc">;;   http://benchmarksgame.alioth.debian.org/</span>
<span class="slc">;;</span>
<span class="slc">;;   contributed by Alexey Voznyuk</span>
<span class="slc">;;</span>

<span class="opt">(</span><span class="kwa">defpackage</span> <span class="opt">#:</span>smp-utils
  <span class="opt">(:</span>use <span class="opt">:</span>cl <span class="opt">:</span>sb-alien <span class="opt">:</span>sb-thread<span class="opt">)</span>
  <span class="opt">(:</span>export <span class="opt">#:</span>affinity <span class="opt">#:</span>apic-core-map<span class="opt">))</span>

<span class="opt">(</span><span class="kwa">in-package</span> <span class="opt">:</span>smp-utils<span class="opt">)</span>

<span class="opt">(</span><span class="kwa">defun</span> <span class="kwb">cpuset-</span><span class="opt">&gt;</span>list <span class="opt">(</span><span class="kwa">cpuset</span><span class="opt">)</span>
  <span class="opt">(</span><span class="kwa">loop</span> <span class="opt">:</span>for i <span class="opt">:</span>from <span class="num">0</span> <span class="opt">:</span>below <span class="num">128</span>
     <span class="opt">:</span>unless <span class="opt">(</span><span class="kwa">zerop</span> <span class="opt">(</span><span class="kwa">ldb</span> <span class="opt">(</span><span class="kwa">byte</span> <span class="num">1</span> <span class="opt">(</span><span class="kwa">mod</span> i <span class="num">8</span><span class="opt">)) (</span><span class="kwa">elt</span> cpuset <span class="opt">(</span><span class="kwa">truncate</span> i <span class="num">8</span><span class="opt">))))</span>
     <span class="opt">:</span>collect i<span class="opt">))</span>

<span class="opt">(</span><span class="kwa">defun</span> <span class="kwb">list-</span><span class="opt">&gt;</span>cpuset <span class="opt">(</span><span class="kwa">cpuset-list</span><span class="opt">)</span>
  <span class="opt">(</span><span class="kwa">loop</span> <span class="opt">:</span>with cpuset <span class="opt">= (</span><span class="kwa">make-array</span> <span class="num">16</span> <span class="opt">:</span>element-type <span class="opt">&apos;(</span><span class="kwa">unsigned-byte</span> <span class="num">8</span><span class="opt">))</span>
     <span class="opt">:</span>for i <span class="opt">:</span>from <span class="num">0</span> <span class="opt">:</span>below <span class="num">128</span>
     <span class="opt">:</span>when <span class="opt">(</span><span class="kwa">find</span> i cpuset-list <span class="opt">:</span>test <span class="opt">#&apos;=)</span>
     <span class="opt">:</span>do <span class="opt">(</span><span class="kwa">setf</span> <span class="opt">(</span><span class="kwa">ldb</span> <span class="opt">(</span><span class="kwa">byte</span> <span class="num">1</span> <span class="opt">(</span><span class="kwa">mod</span> i <span class="num">8</span><span class="opt">)) (</span><span class="kwa">elt</span> cpuset <span class="opt">(</span><span class="kwa">truncate</span> i <span class="num">8</span><span class="opt">)))</span> <span class="num">1</span><span class="opt">)</span>
     <span class="opt">:</span>finally <span class="opt">(</span><span class="kwa">return</span> cpuset<span class="opt">)))</span>

<span class="opt">(</span><span class="kwa">defun</span> <span class="kwb">affinity</span> <span class="opt">(</span><span class="kwa">thread</span><span class="opt">)</span>
  <span class="opt">(</span><span class="kwa">with-alien</span> <span class="opt">((</span><span class="kwa">alien-cpuset</span> <span class="opt">(</span><span class="kwa">array</span> unsigned-char <span class="num">16</span><span class="opt">)))</span>
    <span class="opt">(</span><span class="kwa">let</span> <span class="opt">((</span><span class="kwa">retcode</span> <span class="opt">(</span><span class="kwa">alien-funcall</span> <span class="opt">(</span><span class="kwa">extern-alien</span> <span class="str">&quot;pthread_getaffinity_np&quot;</span> 
                                                <span class="opt">(</span><span class="kwa">function</span> int 
                                                          unsigned-long 
                                                          unsigned-long 
                                                          <span class="opt">(*</span> unsigned-char<span class="opt">)))</span>
                                  <span class="opt">(</span><span class="kwa">sb-thread</span><span class="opt">::</span>thread-os-thread thread<span class="opt">)</span>
                                  <span class="num">16</span>
                                  <span class="opt">(</span><span class="kwa">cast</span> alien-cpuset <span class="opt">(*</span> unsigned-char<span class="opt">)))))</span>
      <span class="opt">(</span><span class="kwa">when</span> <span class="opt">(</span><span class="kwa">zerop</span> retcode<span class="opt">)</span>
        <span class="opt">(</span><span class="kwa">values</span> t <span class="opt">(</span><span class="kwa">loop</span> <span class="opt">:</span>with cpuset <span class="opt">= (</span><span class="kwa">make-array</span> <span class="num">16</span> <span class="opt">:</span>element-type <span class="opt">&apos;(</span><span class="kwa">unsigned-byte</span> <span class="num">8</span><span class="opt">))</span>
                     <span class="opt">:</span>for i <span class="opt">:</span>from <span class="num">0</span> <span class="opt">:</span>below <span class="num">16</span>
                     <span class="opt">:</span>do <span class="opt">(</span><span class="kwa">setf</span> <span class="opt">(</span><span class="kwa">elt</span> cpuset i<span class="opt">) (</span><span class="kwa">deref</span> alien-cpuset i<span class="opt">))</span>
                     <span class="opt">:</span>finally <span class="opt">(</span><span class="kwa">return</span> <span class="opt">(</span><span class="kwa">cpuset-</span><span class="opt">&gt;</span>list cpuset<span class="opt">))))))))</span>

<span class="opt">(</span><span class="kwa">defun</span> <span class="opt">(</span><span class="kwa">setf</span> affinity<span class="opt">) (</span><span class="kwa">affinity</span> thread<span class="opt">)</span>
  <span class="opt">(</span><span class="kwa">with-alien</span> <span class="opt">((</span><span class="kwa">alien-cpuset</span> <span class="opt">(</span><span class="kwa">array</span> unsigned-char <span class="num">16</span><span class="opt">)))</span>
    <span class="opt">(</span><span class="kwa">loop</span> <span class="opt">:</span>with cpuset <span class="opt">= (</span><span class="kwa">list-</span><span class="opt">&gt;</span>cpuset affinity<span class="opt">)</span>
       <span class="opt">:</span>for i <span class="opt">:</span>from <span class="num">0</span> <span class="opt">:</span>below <span class="num">16</span>
       <span class="opt">:</span>do <span class="opt">(</span><span class="kwa">setf</span> <span class="opt">(</span><span class="kwa">deref</span> alien-cpuset i<span class="opt">) (</span><span class="kwa">elt</span> cpuset i<span class="opt">)))</span>
    <span class="opt">(</span><span class="kwa">zerop</span> <span class="opt">(</span><span class="kwa">alien-funcall</span> <span class="opt">(</span><span class="kwa">extern-alien</span> <span class="str">&quot;pthread_setaffinity_np&quot;</span> 
                                        <span class="opt">(</span><span class="kwa">function</span> int 
                                                  unsigned-long 
                                                  unsigned-long 
                                                  <span class="opt">(*</span> unsigned-char<span class="opt">)))</span>
                          <span class="opt">(</span><span class="kwa">sb-thread</span><span class="opt">::</span>thread-os-thread thread<span class="opt">)</span>
                          <span class="num">16</span>
                          <span class="opt">(</span><span class="kwa">cast</span> alien-cpuset <span class="opt">(*</span> unsigned-char<span class="opt">))))))</span>

<span class="opt">(</span><span class="kwa">defun</span> <span class="kwb">apic-core-map</span> <span class="opt">(</span><span class="kwa">cpuset-list</span><span class="opt">)</span>
  <span class="opt">(</span><span class="kwa">let</span> <span class="opt">((</span><span class="kwa">default-map</span> <span class="opt">(</span><span class="kwa">mapcar</span> <span class="opt">#&apos;</span>list cpuset-list cpuset-list<span class="opt">)))</span>
    <span class="opt">(</span><span class="kwa">unless</span> <span class="opt">(</span><span class="kwa">probe-file</span> <span class="opt">#</span>p<span class="str">&quot;/proc/cpuinfo&quot;</span><span class="opt">)</span>
      <span class="opt">(</span><span class="kwa">return-from</span> apic-core-map default-map<span class="opt">))</span>
    <span class="opt">(</span><span class="kwa">with-open-file</span> <span class="opt">(</span><span class="kwa">cpuinfo</span> <span class="opt">#</span>p<span class="str">&quot;/proc/cpuinfo&quot;</span><span class="opt">)</span>
      <span class="opt">(</span><span class="kwa">flet</span> <span class="opt">((</span><span class="kwa">parse-key-value</span> <span class="opt">(</span><span class="kwa">line</span> key<span class="opt">)</span>
               <span class="opt">(</span><span class="kwa">when</span> <span class="opt">(</span><span class="kwa">and</span> <span class="opt">(&gt; (</span><span class="kwa">length</span> line<span class="opt">) (</span><span class="kwa">length</span> key<span class="opt">))</span>
                          <span class="opt">(</span><span class="kwa">string</span><span class="opt">=</span> line key <span class="opt">:</span>end1 <span class="opt">(</span><span class="kwa">length</span> key<span class="opt">)))</span>
                 <span class="opt">(</span><span class="kwa">let</span> <span class="opt">((</span><span class="kwa">value-offset</span> <span class="opt">(</span><span class="kwa">position</span> <span class="opt">#</span>\<span class="opt">:</span> line <span class="opt">:</span>start <span class="opt">(</span><span class="kwa">length</span> key<span class="opt">))))</span>
                   <span class="opt">(</span><span class="kwa">when</span> value-offset
                     <span class="opt">(</span><span class="kwa">parse-integer</span> line <span class="opt">:</span>start <span class="opt">(</span><span class="kwa">1</span><span class="opt">+</span> value-offset<span class="opt">) :</span>junk-allowed t<span class="opt">))))))</span>
        <span class="opt">(</span><span class="kwa">loop</span> <span class="opt">:</span>with current-cpu <span class="opt">=</span> nil
           <span class="opt">:</span>for line <span class="opt">= (</span><span class="kwa">read-line</span> cpuinfo nil nil<span class="opt">)</span>
           <span class="opt">:</span>while line
           <span class="opt">:</span>do <span class="opt">(</span><span class="kwa">multiple-value-bind</span> <span class="opt">(</span><span class="kwa">processor</span> apicid<span class="opt">)</span>
                   <span class="opt">(</span><span class="kwa">values</span> <span class="opt">(</span><span class="kwa">parse-key-value</span> line <span class="str">&quot;processor&quot;</span><span class="opt">)</span>
                           <span class="opt">(</span><span class="kwa">parse-key-value</span> line <span class="str">&quot;apicid&quot;</span><span class="opt">))</span>
                 <span class="opt">(</span><span class="kwa">cond</span> <span class="opt">((</span><span class="kwa">and</span> current-cpu apicid<span class="opt">) (</span><span class="kwa">setf</span> <span class="opt">(</span><span class="kwa">first</span> <span class="opt">(</span><span class="kwa">find</span> current-cpu default-map <span class="opt">:</span>key <span class="opt">#&apos;</span>second<span class="opt">))</span> apicid
                                                       current-cpu nil<span class="opt">))</span>
                       <span class="opt">(</span><span class="kwa">processor</span> <span class="opt">(</span><span class="kwa">setf</span> current-cpu processor<span class="opt">))))</span>
           <span class="opt">:</span>finally <span class="opt">(</span><span class="kwa">return</span> <span class="opt">(</span><span class="kwa">sort</span> default-map <span class="opt">#&apos;&lt; :</span>key <span class="opt">#&apos;</span>first<span class="opt">)))))))</span>
  

<span class="opt">(</span><span class="kwa">defpackage</span> <span class="opt">#:</span>chameneos-redux
  <span class="opt">(:</span>use <span class="opt">:</span>cl <span class="opt">:</span>smp-utils<span class="opt">))</span>

<span class="opt">(</span><span class="kwa">in-package</span> <span class="opt">:</span>chameneos-redux<span class="opt">)</span>

<span class="slc">;;</span>
<span class="slc">;; Game DSL compiler</span>
<span class="slc">;;</span>

<span class="opt">(</span><span class="kwa">defmacro</span> declare-colors-map <span class="opt">(&amp;</span>rest transformations<span class="opt">)</span>
  <span class="opt">`(</span><span class="kwa">progn</span>
     <span class="opt">(</span><span class="kwa">defun</span> <span class="kwb">complement-color</span> <span class="opt">(</span><span class="kwa">color-a</span> color-b<span class="opt">)</span>
       <span class="opt">(</span><span class="kwa">cond</span>
         <span class="opt">,&#64;(</span><span class="kwa">loop</span>
              <span class="opt">:</span>for <span class="opt">(</span><span class="kwa">test-a</span> kw-plus test-b kw-arrow test-result<span class="opt">) :</span>in transformations
              <span class="opt">:</span>do <span class="opt">(</span><span class="kwa">assert</span> <span class="opt">(</span><span class="kwa">and</span> <span class="opt">(</span><span class="kwa">eq</span> kw-plus <span class="opt">&apos;+) (</span><span class="kwa">eq</span> kw-arrow <span class="opt">&apos;</span>-<span class="opt">&gt;)))</span>
              <span class="opt">:</span>collect <span class="opt">`((</span><span class="kwa">and</span> <span class="opt">(</span><span class="kwa">eq</span> color-a <span class="opt">&apos;,</span>test-a<span class="opt">) (</span><span class="kwa">eq</span> color-b <span class="opt">&apos;,</span>test-b<span class="opt">))</span>
                         <span class="opt">&apos;,</span>test-result<span class="opt">))</span>
         <span class="opt">(</span><span class="kwa">t</span> <span class="opt">(</span><span class="kwa">error</span> <span class="str">&quot;Invalid colors combinations&quot;</span><span class="opt">))))</span>
     <span class="opt">(</span><span class="kwa">defun</span> <span class="kwb">print-colors</span> <span class="opt">()</span>
       <span class="opt">(</span><span class="kwa">format</span> t <span class="str">&quot;玺狺}%&quot;</span>
               <span class="opt">(</span><span class="kwa">list</span> <span class="opt">,&#64;(</span><span class="kwa">loop</span>
                          <span class="opt">:</span>for <span class="opt">(</span><span class="kwa">test-a</span> kw-plus test-b<span class="opt">) :</span>in transformations
                          <span class="opt">:</span>collect <span class="opt">`(</span><span class="kwa">list</span> <span class="opt">,(</span><span class="kwa">string-downcase</span> <span class="opt">(</span><span class="kwa">string</span> test-a<span class="opt">))</span>
                                          <span class="opt">,(</span><span class="kwa">string-downcase</span> <span class="opt">(</span><span class="kwa">string</span> test-b<span class="opt">))</span>
                                          <span class="opt">(</span><span class="kwa">string-downcase</span>
                                           <span class="opt">(</span><span class="kwa">string</span> <span class="opt">(</span><span class="kwa">complement-color</span> <span class="opt">&apos;,</span>test-a
                                                                     <span class="opt">&apos;,</span>test-b<span class="opt">))))))))))</span>

<span class="opt">(</span><span class="kwa">defun</span> <span class="kwb">spell-number</span> <span class="opt">(</span><span class="kwa">number</span><span class="opt">)</span>
  <span class="opt">(</span><span class="kwa">with-output-to-string</span> <span class="opt">(</span><span class="kwa">result-string</span><span class="opt">)</span>
    <span class="opt">(</span><span class="kwa">loop</span>
       <span class="opt">:</span>for char <span class="opt">:</span>across <span class="opt">(</span><span class="kwa">the</span> simple-string <span class="opt">(</span><span class="kwa">format</span> nil <span class="str">&quot;a&quot;</span> number<span class="opt">))</span>
       <span class="opt">:</span>do <span class="opt">(</span><span class="kwa">format</span> result-string <span class="str">&quot; r&quot;</span> <span class="opt">(</span><span class="kwa">-</span> <span class="opt">(</span><span class="kwa">char-code</span> char<span class="opt">) (</span><span class="kwa">char-code</span> <span class="opt">#</span>\<span class="num">0</span><span class="opt">))))))</span>

<span class="opt">(</span><span class="kwa">defmacro</span> spin-wait <span class="opt">(</span><span class="kwa">condition</span> <span class="opt">&amp;</span>key no-spin<span class="opt">)</span>
  <span class="opt">(</span><span class="kwa">let</span> <span class="opt">((</span><span class="kwa">yield-spin</span> <span class="opt">`(</span><span class="kwa">loop</span> <span class="opt">:</span>until <span class="opt">,</span>condition <span class="opt">:</span>do <span class="opt">(</span><span class="kwa">sb-thread</span><span class="opt">:</span>thread-yield<span class="opt">))))</span>
    <span class="opt">(</span><span class="kwa">if</span> no-spin
        yield-spin
        <span class="opt">`(</span><span class="kwa">loop</span>
            <span class="opt">:</span>repeat <span class="num">16384</span>
            <span class="opt">:</span>do <span class="opt">(</span><span class="kwa">when</span> <span class="opt">,</span>condition
                  <span class="opt">(</span><span class="kwa">return</span><span class="opt">))</span>
            <span class="opt">:</span>finally <span class="opt">,</span>yield-spin<span class="opt">))))</span>

<span class="opt">(</span><span class="kwa">defstruct</span> chameneo
  <span class="opt">(</span><span class="kwa">color</span> <span class="opt">&apos;</span>none <span class="opt">:</span>type symbol<span class="opt">)</span>
  <span class="opt">(</span><span class="kwa">meet-count</span> <span class="num">0</span> <span class="opt">:</span>type fixnum<span class="opt">)</span>
  <span class="opt">(</span><span class="kwa">same-count</span> <span class="num">0</span> <span class="opt">:</span>type fixnum<span class="opt">)</span>
  <span class="opt">(</span><span class="kwa">meet-wait</span> nil <span class="opt">:</span>type boolean<span class="opt">))</span>

<span class="opt">(</span><span class="kwa">defmacro</span> with-games <span class="opt">((&amp;</span>rest descriptions<span class="opt">) &amp;</span>body body<span class="opt">)</span>
  <span class="opt">(</span><span class="kwa">if</span> <span class="opt">(</span><span class="kwa">null</span> descriptions<span class="opt">)</span>
      <span class="opt">`(</span><span class="kwa">progn</span> <span class="opt">,&#64;</span>body<span class="opt">)</span>
      <span class="opt">(</span><span class="kwa">destructuring-bind</span> <span class="opt">(</span><span class="kwa">game-name</span> <span class="opt">&amp;</span>rest colors<span class="opt">)</span>
          <span class="opt">(</span><span class="kwa">car</span> descriptions<span class="opt">)</span>
        <span class="opt">(</span><span class="kwa">let</span><span class="opt">* ((</span><span class="kwa">colors-count</span> <span class="opt">(</span><span class="kwa">length</span> colors<span class="opt">))</span>
               <span class="opt">(</span><span class="kwa">worker-binds</span> <span class="opt">(</span><span class="kwa">loop</span> <span class="opt">:</span>repeat colors-count <span class="opt">:</span>collect <span class="opt">(</span><span class="kwa">gensym</span><span class="opt">)))</span>
               <span class="opt">(</span><span class="kwa">chameneos</span> <span class="opt">(</span><span class="kwa">gensym</span> <span class="str">&quot;CHAMENEOS&quot;</span><span class="opt">))</span>
               <span class="opt">(</span><span class="kwa">action-cas</span> <span class="opt">(</span><span class="kwa">gensym</span> <span class="str">&quot;ACTION-CAS&quot;</span><span class="opt">)))</span>
          <span class="opt">`(</span><span class="kwa">let</span> <span class="opt">((,</span>chameneos <span class="opt">(</span><span class="kwa">coerce</span> <span class="opt">(</span><span class="kwa">list</span> <span class="opt">,&#64;(</span><span class="kwa">loop</span> <span class="opt">:</span>repeat colors-count <span class="opt">:</span>collect <span class="opt">`(</span><span class="kwa">make-chameneo</span><span class="opt">)))</span>
                                     <span class="opt">&apos;</span>simple-vector<span class="opt">))</span>
                 <span class="opt">(,</span>action-cas <span class="opt">(</span><span class="kwa">list</span> <span class="num">0</span><span class="opt">))</span>
                 <span class="opt">,&#64;</span>worker-binds<span class="opt">)</span>
             <span class="opt">(</span><span class="kwa">declare</span> <span class="opt">(</span><span class="kwa">type</span> <span class="opt">(</span><span class="kwa">simple-vector</span> <span class="opt">,</span>colors-count<span class="opt">) ,</span>chameneos<span class="opt">)</span>
                      <span class="opt">(</span><span class="kwa">type</span> cons <span class="opt">,</span>action-cas<span class="opt">)</span>
                      <span class="opt">(</span><span class="kwa">type</span> <span class="opt">(</span><span class="kwa">or</span> null sb-thread<span class="opt">:</span>thread<span class="opt">) ,&#64;</span>worker-binds<span class="opt">))</span>
             <span class="opt">(</span><span class="kwa">flet</span> <span class="opt">((,(</span><span class="kwa">intern</span> <span class="opt">(</span><span class="kwa">format</span> nil <span class="str">&quot;RUN-a&quot;</span> game-name<span class="opt">)) (</span><span class="kwa">count</span> threads-affinity smp-p<span class="opt">)</span>
                      <span class="opt">(</span><span class="kwa">declare</span> <span class="opt">(</span><span class="kwa">type</span> fixnum count<span class="opt">) (</span><span class="kwa">type</span> list threads-affinity<span class="opt">) (</span><span class="kwa">type</span> boolean smp-p<span class="opt">))</span>
                      <span class="opt">(</span><span class="kwa">setf</span> <span class="opt">(</span><span class="kwa">car</span> <span class="opt">,</span>action-cas<span class="opt">) (</span><span class="kwa">the</span> fixnum <span class="opt">(</span><span class="kwa">ash</span> count <span class="opt">,(</span><span class="kwa">integer-length</span> <span class="opt">(</span><span class="kwa">1</span><span class="opt">+</span> colors-count<span class="opt">)))))</span>
                      <span class="opt">(</span><span class="kwa">flet</span> <span class="opt">((</span><span class="kwa">color-worker</span> <span class="opt">(</span><span class="kwa">id</span> color<span class="opt">)</span>
                               <span class="opt">(</span><span class="kwa">declare</span> <span class="opt">(</span><span class="kwa">type</span> <span class="opt">(</span><span class="kwa">integer</span> <span class="num">0</span> <span class="opt">,(</span><span class="kwa">1-</span> colors-count<span class="opt">))</span> id<span class="opt">) (</span><span class="kwa">type</span> symbol color<span class="opt">))</span>
                               <span class="opt">(</span><span class="kwa">lambda</span> <span class="opt">()</span>
                                 <span class="opt">(</span><span class="kwa">setf</span> <span class="opt">(</span><span class="kwa">affinity</span> sb-thread<span class="opt">:*</span>current-thread<span class="opt">*)</span> threads-affinity<span class="opt">)</span>
                                 <span class="opt">(</span><span class="kwa">let</span> <span class="opt">((</span><span class="kwa">state</span> <span class="opt">(</span><span class="kwa">car</span> <span class="opt">,</span>action-cas<span class="opt">))</span>
                                       <span class="opt">(</span><span class="kwa">self</span> <span class="opt">(</span><span class="kwa">elt</span> <span class="opt">,</span>chameneos id<span class="opt">)))</span>
                                   <span class="opt">(</span><span class="kwa">declare</span> <span class="opt">(</span><span class="kwa">type</span> <span class="opt">(</span><span class="kwa">integer</span> <span class="num">0</span> <span class="opt">,</span>most-positive-fixnum<span class="opt">)</span> state<span class="opt">)</span>
                                            <span class="opt">(</span><span class="kwa">type</span> chameneo self<span class="opt">))</span>
                                   <span class="opt">(</span><span class="kwa">setf</span> <span class="opt">(</span><span class="kwa">chameneo-color</span> self<span class="opt">)</span> color<span class="opt">)</span>
                                   <span class="opt">(</span><span class="kwa">loop</span>
                                      <span class="opt">(</span><span class="kwa">when</span> <span class="opt">(</span><span class="kwa">zerop</span> state<span class="opt">)</span>
                                        <span class="opt">(</span><span class="kwa">return</span><span class="opt">))</span>
                                      <span class="opt">(</span><span class="kwa">let</span><span class="opt">* ((</span><span class="kwa">peer-id</span> <span class="opt">(</span><span class="kwa">logand</span> state <span class="opt">,(</span><span class="kwa">1-</span> <span class="opt">(</span><span class="kwa">ash</span> <span class="num">1</span> <span class="opt">(</span><span class="kwa">integer-length</span> <span class="opt">(</span><span class="kwa">1</span><span class="opt">+</span> colors-count<span class="opt">))))))</span>
                                             <span class="opt">(</span><span class="kwa">new-state</span> <span class="opt">(</span><span class="kwa">if</span> <span class="opt">(</span><span class="kwa">zerop</span> peer-id<span class="opt">)</span>
                                                            <span class="opt">(</span><span class="kwa">logior</span> state <span class="opt">(</span><span class="kwa">1</span><span class="opt">+</span> id<span class="opt">))</span>
                                                            <span class="opt">(</span><span class="kwa">-</span> state peer-id <span class="opt">,(</span><span class="kwa">ash</span> <span class="num">1</span> <span class="opt">(</span><span class="kwa">integer-length</span> <span class="opt">(</span><span class="kwa">1</span><span class="opt">+</span> colors-count<span class="opt">)))))))</span>
                                        <span class="opt">(</span><span class="kwa">declare</span> <span class="opt">(</span><span class="kwa">type</span> <span class="opt">(</span><span class="kwa">integer</span> <span class="num">0</span> <span class="opt">,(</span><span class="kwa">1</span><span class="opt">+</span> colors-count<span class="opt">))</span> peer-id<span class="opt">)</span>
                                                 <span class="opt">(</span><span class="kwa">type</span> <span class="opt">(</span><span class="kwa">integer</span> <span class="num">0</span> <span class="opt">,</span>most-positive-fixnum<span class="opt">)</span> new-state<span class="opt">))</span>
                                        <span class="opt">(</span><span class="kwa">let</span> <span class="opt">((</span><span class="kwa">prev-state</span> <span class="opt">(</span><span class="kwa">sb-ext</span><span class="opt">:</span>compare-and-swap <span class="opt">(</span><span class="kwa">car</span> <span class="opt">,</span>action-cas<span class="opt">)</span> state new-state<span class="opt">)))</span>
                                          <span class="opt">(</span><span class="kwa">declare</span> <span class="opt">(</span><span class="kwa">type</span> <span class="opt">(</span><span class="kwa">integer</span> <span class="num">0</span> <span class="opt">,</span>most-positive-fixnum<span class="opt">)</span> prev-state<span class="opt">))</span>
                                          <span class="opt">(</span><span class="kwa">if</span> <span class="opt">(=</span> prev-state state<span class="opt">)</span>
                                              <span class="opt">(</span><span class="kwa">progn</span> 
                                                <span class="opt">(</span><span class="kwa">if</span> <span class="opt">(</span><span class="kwa">zerop</span> peer-id<span class="opt">)</span>
                                                    <span class="opt">(</span><span class="kwa">progn</span>
                                                      <span class="opt">(</span><span class="kwa">if</span> smp-p
                                                          <span class="opt">(</span><span class="kwa">spin-wait</span> <span class="opt">(</span><span class="kwa">chameneo-meet-wait</span> self<span class="opt">))</span>
                                                          <span class="opt">(</span><span class="kwa">spin-wait</span> <span class="opt">(</span><span class="kwa">chameneo-meet-wait</span> self<span class="opt">) :</span>no-spin t<span class="opt">))</span>
                                                      <span class="opt">(</span><span class="kwa">setf</span> <span class="opt">(</span><span class="kwa">chameneo-meet-wait</span> self<span class="opt">)</span> nil<span class="opt">))</span>
                                                    <span class="opt">(</span><span class="kwa">let</span> <span class="opt">((</span><span class="kwa">peer</span> <span class="opt">(</span><span class="kwa">elt</span> <span class="opt">,</span>chameneos <span class="opt">(</span><span class="kwa">1-</span> peer-id<span class="opt">))))</span>
                                                      <span class="opt">(</span><span class="kwa">when</span> <span class="opt">(=</span> id <span class="opt">(</span><span class="kwa">1-</span> peer-id<span class="opt">))</span>
                                                        <span class="opt">(</span><span class="kwa">incf</span> <span class="opt">(</span><span class="kwa">chameneo-same-count</span> self<span class="opt">))</span>
                                                        <span class="opt">(</span><span class="kwa">incf</span> <span class="opt">(</span><span class="kwa">chameneo-same-count</span> peer<span class="opt">)))</span>
                                                      <span class="opt">(</span><span class="kwa">let</span> <span class="opt">((</span><span class="kwa">new-color</span> <span class="opt">(</span><span class="kwa">complement-color</span> <span class="opt">(</span><span class="kwa">chameneo-color</span> self<span class="opt">)</span>
                                                                                         <span class="opt">(</span><span class="kwa">chameneo-color</span> peer<span class="opt">))))</span>
                                                        <span class="opt">(</span><span class="kwa">declare</span> <span class="opt">(</span><span class="kwa">type</span> symbol new-color<span class="opt">))</span>
                                                        <span class="opt">(</span><span class="kwa">setf</span> <span class="opt">(</span><span class="kwa">chameneo-color</span> self<span class="opt">)</span> new-color
                                                              <span class="opt">(</span><span class="kwa">chameneo-color</span> peer<span class="opt">)</span> new-color<span class="opt">)</span>
                                                        <span class="opt">(</span><span class="kwa">incf</span> <span class="opt">(</span><span class="kwa">chameneo-meet-count</span> self<span class="opt">))</span>
                                                        <span class="opt">(</span><span class="kwa">incf</span> <span class="opt">(</span><span class="kwa">chameneo-meet-count</span> peer<span class="opt">))</span>
                                                        <span class="opt">(</span><span class="kwa">setf</span> <span class="opt">(</span><span class="kwa">chameneo-meet-wait</span> peer<span class="opt">)</span> t<span class="opt">))))</span>
                                                <span class="opt">(</span><span class="kwa">setf</span> state <span class="opt">(</span><span class="kwa">car</span> <span class="opt">,</span>action-cas<span class="opt">)))</span>
                                              <span class="opt">(</span><span class="kwa">setf</span> state prev-state<span class="opt">)))))))))</span>
                        <span class="opt">,&#64;(</span><span class="kwa">loop</span> <span class="opt">:</span>for color <span class="opt">:</span>in colors <span class="opt">:</span>for thread-index <span class="opt">:</span>from <span class="num">0</span>
                             <span class="opt">:</span>collect <span class="opt">`(</span><span class="kwa">setf</span> <span class="opt">,(</span><span class="kwa">elt</span> worker-binds thread-index<span class="opt">)</span>
                                             <span class="opt">(</span><span class="kwa">sb-thread</span><span class="opt">:</span>make-thread <span class="opt">(</span><span class="kwa">color-worker</span> <span class="opt">,</span>thread-index <span class="opt">&apos;,</span>color<span class="opt">)</span>
                                                                    <span class="opt">:</span>name <span class="opt">,(</span><span class="kwa">format</span> nil <span class="str">&quot;chameneos-worker-a-a/a&quot;</span>
                                                                                   <span class="opt">(</span><span class="kwa">string-downcase</span> <span class="opt">(</span><span class="kwa">string</span> color<span class="opt">))</span>
                                                                                   thread-index
                                                                                   colors-count<span class="opt">)))))</span>
                      nil<span class="opt">)</span>
                    <span class="opt">(,(</span><span class="kwa">intern</span> <span class="opt">(</span><span class="kwa">format</span> nil <span class="str">&quot;WAIT-a&quot;</span> game-name<span class="opt">)) ()</span>
                      <span class="opt">,&#64;(</span><span class="kwa">loop</span> <span class="opt">:</span>for i <span class="opt">:</span>from <span class="num">0</span> <span class="opt">:</span>below colors-count <span class="opt">:</span>collect <span class="opt">`(</span><span class="kwa">sb-thread</span><span class="opt">:</span>join-thread <span class="opt">,(</span><span class="kwa">elt</span> worker-binds i<span class="opt">)))</span>
                      <span class="opt">(</span><span class="kwa">format</span> t <span class="opt">,(</span><span class="kwa">format</span> nil <span class="str">&quot;狺ウ聃雉患箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕祜镳集箴犷俭疳沆狍蠼镳簪竞集箴犷炬矧泔祜俭疳沆狍蠼镳簪竞集箴犷鹃泔祜蝮俭疳沆狍蠼镳簪竞集箴犷俱镬戾泗俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕篝蜷铉滹黝汜箦集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕篝蜷铉集箴犷泔祜蚣箴犷沆狍蠼镳簪京┅┅集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕祜镳集箴犷俭疳沆狍蠼镳簪竞集箴犷炬矧俭疳沆狍蠼镳簪竞集箴犷炬蝻俭疳沆狍蠼㈩蹴⒕凹箴犷俭疳沆狍蠼镳簪竞集箴犷锯屐秣俭疳沆狍蠼镳簪粳集箴犷俱镬矧蟓泔躅俭疳沆狍蠼镳簪竞集箴犷倔蹴黹铉俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕汨犴孱屣礤弭泔躅艏箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕屐艏箴犷俭疳沆狍蠼镳簪粳集箴犷俱栳礤铄矬榧箴犷沆狍蠼镳簪京杭箴犷鹃铘麸翎俭疳沆狍蠼镳簪竞集箴犷撅姝豉疱骈铛俭疳沆狍蠼镳簪竞集箴犷句俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕骘蝽狒集箴犷俭疳沆狍蠼Ⅲ趄⒕聃雉箕狺狺ウ聃雉患箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕汨犴孱屣礤弭泔躅艏箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕屐艏箴犷俭疳沆狍蠼镳簪粳集箴犷俱栳礤铄矬榧箴犷沆狍蠼镳簪京┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕箴屐飙铛礅弪集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕汨犴孱屣筢礤泔躅艏箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕屐艏箴犷俭疳沆狍蠼镳簪粳集箴犷俱栳礤铄矬榧箴犷沆狍蠼镳簪京┅┘箴犷俭疳沆狍蠼镳簪竞集箴犷炬轭犰禊俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕骘蝽狒集箴犷俭疳沆狍蠼Ⅲ趄⒕聃雉箕狺ウ聃雉患箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕箴屐飙铛礅弪集箴犷麸翎旒箴犷沆狍蠼镳簪京┅┅集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕鏖翳玑礤蠹箴犷俭疳沆狍蠼镳簪鲸Γ洞花集箴犷炯箴犷沆狍蠼㈦麽⒕沅蚣箴犷溴筱蜷痿轱铙俭疳沆狍蠼镳簪京┘箴犷俭疳沆狍蠼镳簪粳Γ洞患箴犷锯镤俭疳沆狍蠼镳簪京┅┅┅集箴犷俭疳沆狍蠼Ⅲ煦⒕换集箴犷俭疳沆狍蠼Ⅲ煦⒕换轻礤泔铘孱趔集箴犷俭疳沆狍蠼Ⅲ煦⒕换集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕痱镧罴箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴沆狎瀛泔祜蝮磲鸺箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕忪蹂集箴犷俭疳沆狍蠼镳簪精集箴犷忪蹂俭疳沆狍蠼镳簪睛玺患箴犷忪蹂俭疳沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕忪蹂集箴犷俭疳沆狍蠼镳簪精集箴犷蝈俭疳沆狍蠼镳簪睛玺患箴犷屐祜骷箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕忪蹂集箴犷俭疳沆狍蠼镳簪精集箴犷屐祜俭疳沆狍蠼镳簪睛玺患箴犷蝈浼箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕蝈浼箴犷俭疳沆狍蠼镳簪精集箴犷忪蹂俭疳沆狍蠼镳簪睛玺患箴犷屐祜骷箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕蝈浼箴犷俭疳沆狍蠼镳簪精集箴犷蝈俭疳沆狍蠼镳簪睛玺患箴犷蝈浼箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕蝈浼箴犷俭疳沆狍蠼镳簪精集箴犷屐祜俭疳沆狍蠼镳簪睛玺患箴犷忪蹂俭疳沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕屐祜骷箴犷俭疳沆狍蠼镳簪精集箴犷忪蹂俭疳沆狍蠼镳簪睛玺患箴犷蝈浼箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕屐祜骷箴犷俭疳沆狍蠼镳簪精集箴犷蝈俭疳沆狍蠼镳簪睛玺患箴犷忪蹂俭疳沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕屐祜骷箴犷俭疳沆狍蠼镳簪精集箴犷屐祜俭疳沆狍蠼镳簪睛玺患箴犷屐祜骷箴犷沆狍蠼镳簪京┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴骢罴箴犷俭疳沆狍蠼㈦麾⒕蝓瞽玑礤蠹箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕泔躅艏箴犷沲蝌孱舡徭骈铋豉俭疳沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴沆狎寮箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕镳糸黹寮箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕箴邋浼箴犷俭疳沆狍蠼㈩蹴⒕臣箴犷炯箴犷沆狍蠼镳簪京集箴犷炯箴犷沆狍蠼㈦麽⒕筢驽豉集箴犷俭疳沆狍蠼㈩蹴⒕凹箴犷炯箴犷沆狍蠼镳簪京集箴犷炯箴犷沆狍蠼㈦麽⒕溴怩缂箴犷俭疳沆狍蠼㈩蹴⒕凹箴犷炯箴犷沆狍蠼镳簪京┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕豉疱集箴犷骈铛泔躅艏箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕豉疱集箴犷扉篝沲蝌孱舡徭骈铋豉俭疳沆狍蠼镳簪京┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕戾艏箴犷炯箴犷沆狍蠼镳簪惊è集箴犷炯箴犷沆狍蠼㈦麽⒕徙糸鲥泔蝈蠹箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕戾铉翳集箴犷沲蝌孱舡徭骈铋豉俭疳沆狍蠼镳簪京┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕箜瓠鸺箴犷俭疳沆狍蠼镳簪鲸玺患箴犷徙糸鲥泔蝈俭疳沆狍蠼㈩蹴⒕奔箴犷炯箴犷沆狍蠼镳簪京┅集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕鏖翳玑礤蠹箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕玑礤峒箴犷忪蹂蝈屐祜骷箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕玑礤饧箴犷忪蹂蝈屐祜蝈屐祜忪蹂蝈屐祜蝈忪蹂俭疳沆狍蠼镳簪京┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕殒集箴犷箜瓠俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕眭祠轲戾鲠祯瀛忾钿集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕徭骈铋豉峒箴犷徭骈铋豉饧箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕殒集箴犷俭疳沆狍蠼镳簪鲸祠患箴犷徙糸鲥泔蝈俭疳沆狍蠼㈩蹴⒕醇箴犷炯箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕鲠祯弩集箴犷沲蝌孱舡徭骈铋豉沲蝌孱舡徭骈铋豉俭疳沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕戾艏箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕狃殂磲鸺箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕狃殂泔蝈磲鸺箴犷沲蝌孱舡徭骈铋豉俭疳沆狍蠼镳簪京┅集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴沆狎寮箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕豉疱集箴犷扉篝狃殂磲鸺箴犷沆狍蠼镳簪京┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕鲠祯弩集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕扉篝集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕箦泔钿集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕屐艏箴犷狃殂磲俭疳沆狍蠼㈩蹴⒕凹箴犷炯箴犷沆狍蠼镳簪京集箴犷炯箴犷沆狍蠼㈦麽⒕箦泔钿集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕屐艏箴犷狃殂磲俭疳沆狍蠼㈩蹴⒕奔箴犷炯箴犷沆狍蠼镳簪京┅集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕扉篝集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕箦泔钿集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕屐艏箴犷狃殂磲俭疳沆狍蠼㈩蹴⒕布箴犷炯箴犷沆狍蠼镳簪京集箴犷炯箴犷沆狍蠼㈦麽⒕箦泔钿集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕屐艏箴犷狃殂磲俭疳沆狍蠼㈩蹴⒕臣箴犷炯箴犷沆狍蠼镳簪京┅┅┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕蝓瞽玑礤峒箴犷泔躅徭骈铋豉箜瓠鸺箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕蝓瞽玑礤饧箴犷泔躅徭骈铋豉箜瓠鸺箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕麽轸玑礤峒箴犷炯箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕麽轸玑礤饧箴犷炯箴犷沆狍蠼镳簪京┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕痱镧罴箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕蝓瞽玑礤峒箴犷泔躅沲蝌孱舡徭骈铋豉箜瓠鸺箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕麽轸玑礤峒箴犷炯箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕蝓瞽玑礤饧箴犷泔躅沲蝌孱舡徭骈铋豉箜瓠鸺箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕麽轸玑礤饧箴犷炯箴犷沆狍蠼镳簪京┅┅┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴骢罴箴犷俭疳沆狍蠼㈦麾⒕磲轭集箴犷俭疳沆狍蠼镳簪鲸犴鸹集箴犷撅痿轱钺骘蜚瀛泔躅艏箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕戾艏箴犷炯箴犷沆狍蠼镳簪惊è集箴犷炯箴犷沆狍蠼㈦麽⒕狎珞集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕沅蚣箴犷筲屮艏箴犷沆狍蠼镳簪竞集箴犷攫矬轼狎琏俭疳沆狍蠼镳簪惊┅集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕泔躅艏箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕矧集箴犷骘蜚瀛泔躅俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕殒集箴犷狎珞俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕疳蝮瀛轭翦珏蚣箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕汜蚣箴犷狎珞俭疳沆狍蠼镳簪京┘箴犷俭疳沆狍蠼㈩蹴⒕栋凹箴犷炯箴犷沆狍蠼镳簪京┅┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕痱轭舡泔祜蝮集箴犷炯箴犷沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕眭祠轲戾鲠祯瀛忾钿集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕篚沣弩蟓鸺箴犷沲蝌孱舡徭骈铋豉俭疳沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕徭骈铋豉集箴犷筲翳蝈徜俭疳沆狍蠼镳簪竞集箴犷俱躜蝈铘翳蝈徜俭疳沆狍蠼镳簪惊┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕躅戾篌集箴犷篚沣弩蟓俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕弪蝻蚣箴犷俭疳沆狍蠼Ⅲ趄⒕聃雉黄衢戾麸蝈趄殄鲥沲蝌孱翳蝈徜徭骈铋豉聃雉患箴犷炯箴犷沆狍蠼镳簪京┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕蝓瞽玑礤蠹箴犷泔躅沲蝌孱舡徭骈铋豉俭疳沆狍蠼镳簪京┅┅集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕轭疳汶徵寮箴犷俭疳沆狍蠼镳簪竞集箴犷俱飙躞弪俭疳沆狍蠼镳簪京集箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴骢罴箴犷俭疳沆狍蠼㈦麾⒕磲轭集箴犷俭疳沆狍蠼镳簪鲸┘箴犷俭疳沆狍蠼镳簪鲸集箴犷炯箴犷沆狍蠼㈦麽⒕汨犴孱屣蟓蝈漉集箴犷炯箴犷沆狍蠼镳簪竞杭箴犷卷衢罴箴犷沆狍蠼镳簪京┘箴犷集痱寰集箦泗轱罹俭邈糸镱艰殇舰祜纰绢雉弩泔眄犷洵扉铄犷痱镧蜥秕麴豸集璩拣蝈蜗耘雍洞忾这躅趱聃徜泔蝈勇锰碑串澡醅捕香舶狈倍翰岛狈峭土伺沭с栳礤铄矬蝈漉筲沆钞筲沆犷М汨犴孱屣篁邃貘筲沆钞筲沆狎翳筢礤骈戾勇锰怩殪鏖翳镳舣篁惘筲沆碑串隘忾畀筲沆躞弪轭轸溴霪铛祆忉翥弼犰Ж祜徜聃雉汇栳礤铄矬蝈漉筲沆钞筲沆咩镯痖戾聃雉哗＃釉烈汨犴孱屣篁邃貘筲沆钞筲沆咩镯痖戾ㄨ犷潇弪忾钿è筲屮艉溴驺镱篝犷舡躅羼灬礅溽ㄣㄡ怙螋悌┅祜徜ㄣ镯痖戾骈戾聃雉汇栳礤铄矬蝈漉筲沆钞筲沆聃雉┅筢鲥扉箴犷洵溟聃雉惑忏飚泔蝈聃雉吼躜殒舂＃盼汨犴孱屣篁邃貘筲沆钞筲沆咩镯痖戾泔眇殪轭骈戾聃雉化栾礤漉铊犴忮钽桧狎塍玑礤忮钽璇汨犴孱屣篁邃貘汨犴孱屣篁邃貘筲沆钞筲沆聃雉黩轸翦泊柿舶背氨翰埠吵型┖泔眇殪轭呐菩撩肆桥：油协赵商泔眇殪轭ㄉ苇辛盟燎河托赵商萤泔眇殪轭呐普眯沼旁玺惶捎泔眇殪轭呐普躺釉玺幻姓优泔眇殪轭呐普疗粕紊再泔眇殪轭呐普ㄓ旁疗粕紊再泔眇殪轭呐普列擅孟遗土泔眇殪轭呐菩撩肆桥：萌镣盼畔迎遗恼泔眇殪轭ㄉ苇辛盟燎好攘团闻嫌遗恼丞泔眇殪轭呐仆撩蚁呐锰烈怒孟滔矣土泔眇殪轭呐普有盘汰握吐乓泔眇殪轭呐仆撩蚁有晌琢稍泔眇殪轭呐朴砸彰萌镣盼畔泔眇殪轭呐仆撩蚁咨匀橇团泔眇殪轭呐锰烈怒孟滔矣土绿张泔眇殪轭呐普艺苇橇团泔眇殪轭呐普土晌泔眇殪轭ㄉ苇辛盟燎好汰沼乓泔眇殪轭呐普土晌栾礤漉铊犴忮钽桧狎塍玑礤唏踽溷矧瀵汨犴孱屣篁邃貘繇鸠汨犴孱屣篁邃貘筲沆钞驷箪黩轸翦泔眇殪狒轱骈铋箬邃轭昂鞍喊爱舶＃釉烈汨犴孱屣篁邃貘筲沆钞筲沆唑躅磲轭聃轸＃盼汨犴孱屣篁邃貘筲沆钞筲沆唑躅钞烦麸泔眇戾翦犷祜犰磲脲徙糸镱孟屯廖躺闻镳舣篁惘筲沆碑串隘忾畀筲沆铒轭骘蝽泔蝈筲沆泔蝈躞弪轭轸溴霪铛祆祜徜汨犴孱屣篁邃貘筲沆钞筲沆唑躅栋鞍鞍幸锨伊险孕赵忪蹂忪蹂玺忪蹂忪蹂蝈玺屐祜忪蹂屐祜玺蝈蝈忪蹂玺屐祜蝈蝈玺蝈蝈屐祜玺忪蹂屐祜忪蹂玺蝈屐祜蝈玺忪蹂屐祜屐祜玺屐祜忪蹂蝈屐祜创栋恫弪掣刀案弪扯赋补弪镱赭弪弪弪弪弪弪忪蹂蝈屐祜蝈屐祜忪蹂蝈屐祜蝈忪蹂贝刀傅弪狈捕暗弪辈窗冻弪备炊返弪辈兜父弪卑炒捣弪勾蹈斗弪腹刀党弪付案刀弪凡陡贩弪镱赭弪弪弪弪弪弪集痱寰集箦泗轱罹集狎糸沆寰兼镲翦蚓碱狯减炀检榫坚栩彐舰扉沐铙瀹梏盱⒕俭疳罹扉沐铙寮箴犷炯峋集蹯集钺鼍集骘雉弪